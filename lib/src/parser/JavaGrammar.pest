WHITESPACE = _{ " " | "\t" | "\n" }
COMMENT = _{ "/*" ~ (!"*/" ~ ANY)* ~ "*/" }

//ipmlemented
IDENTIFIER ={(ASCII_ALPHA|"_")~(ASCII_ALPHANUMERIC|"_")* }
//ipmlemented
compilationunit = {classdeclaration+}

name    ={IDENTIFIER ~("."~IDENTIFIER)*}
//implemented
classdeclaration = {"class"~IDENTIFIER~"{"~(fielddeclaration|methoddeclaration|constructordeclaration)*~"}"}

//ignored for now
constructordeclaration = {constructordeclarator~constructorbody}
//implemented
fielddeclaration = {typeJ~variabledeclarators~";"}
//implemented
methoddeclaration = {typeJ~methoddeclarator
                    ~(block| ";" )}
//implemented
methoddeclarator ={ IDENTIFIER~"("~")"
		 | IDENTIFIER~"("~formalparameterlist~")"  }
//declared
block            = {"{"~blockstatement*~"}" }

constructordeclarator = { IDENTIFIER~"()"
		 |  IDENTIFIER~"("~formalparameterlist~")"  }

constructorbody	 ={ "{"~"}"
		|"{"~explicitconstructorinvocation~"}"
		|"{"~blockstatement+~"}"
		|"{"~explicitconstructorinvocation~blockstatement+~"}"}


//implemented
typeJ  = {primitivetype
		 | IDENTIFIER}
//implemented
variabledeclarators ={ variabledeclarator~(","~variabledeclarator)* }
//implemented
variabledeclarator ={ IDENTIFIER
		 | IDENTIFIER~"="~expression }

// implemented
blockstatement	 ={ typeJ~variabledeclarators~";"
		 | statement  }


//implemented
formalparameterlist = {formalparameter~(","~formalparameter)*}
//implemented
formalparameter  = {typeJ~IDENTIFIER }

explicitconstructorinvocation = {"this"~"("~")"~";"
		 | "this"~"("~argumentlist~")"~";"}


//implemented
primitivetype    = {"boolean"
		        | "int"
                | "char"
                |"String"
                |"void"
                |"null"}



argumentlist     = {expression~(","~expression)*}




statement = {statementwithouttrailingsubstatement
		 | ifthenstatement
		 | ifthenelsestatement
		 | whilestatement }


statementwithouttrailingsubstatement = {block
		 | emptystatement
		 | expressionstatement
		 | returnstatement }

ifthenstatement  ={ "if"~"("~expression~")"~statement }

ifthenelsestatement = {"if"~"("~expression~")"~statementnoshortif~"else"~statement  }

whilestatement   = {"while"~"("~expression~")"~statement }

expression = {conditionalexpression
		 |  assignment}

emptystatement	 =  {";"  }

expressionstatement ={ statementexpression~";" }

returnstatement  ={ "return"~";"
		 | "return"~expression~";" }

statementnoshortif = {statementwithouttrailingsubstatement
		 | ifthenelsestatementnoshortif
		 | whilestatementnoshortif }

conditionalexpression = {conditionalorexpression
		 | conditionalorexpression~"?"~expression~":"~conditionalexpression }

assignment       ={lefthandside~assignmentoperator~expression }


statementexpression = {assignment
		 | preincrementexpression
		 | predecrementexpression
		 | postfixexpression
		 | methodinvocation
		 | classinstancecreationexpression }

ifthenelsestatementnoshortif ={"if"~"("~expression~")"~statementnoshortif~"else"~statementnoshortif  }

whilestatementnoshortif = {"while"~"("~expression~")"~statementnoshortif }

conditionalorexpression ={ conditionalandexpression~("||"~conditionalandexpression)+}

lefthandside     = {name }

assignmentoperator = {"="
		 | "*="
		 | "/="
		 | "%="
		 | "+="
		 | "-="
		 | "<<="
		 | ">>="
		 | ">>>="
		 | "&="
		 | "^="
		 | "|="}

preincrementexpression = {"++"~unaryexpression }

predecrementexpression = {"--"~unaryexpression }

methodinvocation= {
(name|fieldaccess)~"("~argumentlist?~")" }

classinstancecreationexpression ={ "new"~name~"("~")"
                 | "new"~name~"("~argumentlist~")"  }

conditionalandexpression ={ inclusiveorexpression }

fieldaccess ={(literal
		 | "this"
		 | "("~expression~")"
         | classinstancecreationexpression)~"."~idorfield
}
idorfield={fieldaccess|IDENTIFIER}

unaryexpression	 = {preincrementexpression
		 | predecrementexpression
		 | "+"~unaryexpression
		 | "-"~unaryexpression
		 | unaryexpressionnotplusminus }

postfixexpression = {(primary
		 | name)~("++"|"--" )}

inclusiveorexpression = {exclusiveorexpression~("|"~exclusiveorexpression)*}

primary = {literal
		 | "this"
		 | "("~expression~")"
                 | classinstancecreationexpression
		 | fieldaccess
		 | methodinvocation }

unaryexpressionnotplusminus = {postfixexpression
	         | "~"~unaryexpression
		 | "!"~unaryexpression                          // EXCLMARK wurde mit "!" replaced
		 | castexpression}

exclusiveorexpression ={ andexpression~("^"~andexpression)*}


literal		 = {INTLITERAL
		 | BOOLLITERAL
		 | CHARLITERAL
		 | STRINGLITERAL
		 | primitivetype }

CHARLITERAL = { "'"~ASCII~"'" }

STRINGLITERAL = { "\""~ASCII*~"\"" }

BOOLLITERAL = {"true"|"false"}
INTLITERAL = {NUMBER+
|
            NUMBER+~"."~NUMBER+
}


castexpression	 ={ "("~primitivetype~")"~unaryexpression
 		 | "("~expression~")"~unaryexpressionnotplusminus}

andexpression    = {equalityexpression~("&"~equalityexpression )*}

equalityexpression = {relationalexpression~(("!=" |"==")~relationalexpression)*}


relationalexpression = {
shiftexpression~"instanceof"~name
|shiftexpression~(("<"|">"|"<="|">=")~shiftexpression)*
 }

shiftexpression	 = {additiveexpression }

additiveexpression ={ multiplicativeexpression~(("+"|"-")~multiplicativeexpression)*}

multiplicativeexpression ={ unaryexpression~(("*"|"/"|"%")~unaryexpression)*}

